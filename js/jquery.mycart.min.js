(function(c){var b=(function(){var h={};var g={currencySymbol:"$",classCartIcon:"my-cart-icon",classCartBadge:"my-cart-badge",classProductQuantity:"my-product-quantity",classProductRemove:"my-product-remove",classCheckoutCart:"my-cart-checkout",affixCartIcon:true,showCheckoutModal:true,cartItems:[],clickOnAddToCart:function(j){},afterAddOnCart:function(k,j,l){},clickOnCartIcon:function(k,l,j,m){},checkoutCart:function(k,j,l){},getDiscountPrice:function(k,j,l){return null}};var i=function(j){var k=c.extend({},g);if(typeof j==="object"){c.extend(k,j)}return k};h.getOptions=i;return h}());var f=(function(){var g={};var h=function(i){return +i.toFixed(2)};g.getRoundedNumber=h;return g}());var e=(function(){var j={};localStorage.products=localStorage.products?localStorage.products:"";var p=function(t){var r=-1;var s=g();c.each(s,function(u,v){if(v.id==t){r=u;return}});return r};var o=function(r){localStorage.products=JSON.stringify(r)};var l=function(x,s,r,t,w,v){var u=g();u.push({id:x,name:s,summary:r,price:t,quantity:w,image:v});o(u)};var g=function(){try{var s=JSON.parse(localStorage.products);return s}catch(r){return[]}};var q=function(u,t){var r=p(u);if(r<0){return false}var s=g();s[r].quantity=typeof t==="undefined"?s[r].quantity*1+1:t;o(s);return true};var m=function(w,s,r,t,v,u){if(typeof w==="undefined"){console.error("id required");return false}if(typeof s==="undefined"){console.error("name required");return false}if(typeof u==="undefined"){console.error("image required");return false}if(!c.isNumeric(t)){console.error("price is not a number");return false}if(!c.isNumeric(v)){console.error("quantity is not a number");return false}r=typeof r==="undefined"?"":r;if(!q(w)){l(w,s,r,t,v,u)}};var n=function(){o([])};var k=function(s){var r=g();r=c.grep(r,function(u,t){return u.id!=s});o(r)};var i=function(){var r=0;var s=g();c.each(s,function(t,u){r+=u.quantity*1});return r};var h=function(){var s=g();var r=0;c.each(s,function(t,u){r+=u.quantity*u.price;r=f.getRoundedNumber(r)});return r};j.getAllProducts=g;j.updatePoduct=q;j.setProduct=m;j.clearProduct=n;j.removeProduct=k;j.getTotalQuantity=i;j.getTotalPrice=h;return j}());var a=function(k){var j=b.getOptions(k);var s=c("."+j.classCartIcon);var q=c("."+j.classCartBadge);var w=j.classProductQuantity;var i=j.classProductRemove;var r=j.classCheckoutCart;var u="my-cart-modal";var v="my-cart-table";var g="my-cart-grand-total";var y="my-cart-empty-message";var x="my-cart-discount-price";var h="my-product-total";var p="my-cart-icon-affix";if(k.cartItems&&k.cartItems.constructor===Array){e.clearProduct();c.each(j.cartItems,function(){e.setProduct(this.id,this.name,this.summary,this.price,this.quantity,this.image)})}q.text(e.getTotalQuantity());if(!c("#"+u).length){c("body").append('<div class="modal fade" id="'+u+'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel"><span class="glyphicon glyphicon-shopping-cart"></span> My Cart</h4></div><div class="modal-body"><table class="table table-hover table-responsive" id="'+v+'"></table></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button><button type="button" class="btn btn-primary '+r+'">Checkout</button></div></div></div></div>')}var A=function(){var B=c("#"+v);B.empty();var D=e.getAllProducts();c.each(D,function(){var E=this.quantity*this.price;B.append('<tr title="'+this.summary+'" data-id="'+this.id+'" data-price="'+this.price+'"><td class="text-center" style="width: 30px;"><img width="30px" height="30px" src="'+this.image+'"/></td><td>'+this.name+'</td><td title="Unit Price">'+j.currencySymbol+this.price+'</td><td title="Quantity"><input type="number" min="1" style="width: 70px;" class="'+w+'" value="'+this.quantity+'"/></td><td title="Total" class="'+h+'">'+j.currencySymbol+E+'</td><td title="Remove from Cart" class="text-center" style="width: 30px;"><a href="javascript:void(0);" class="btn btn-xs btn-danger '+i+'">X</a></td></tr>')});B.append(D.length?'<tr><td></td><td><strong>Total</strong></td><td></td><td></td><td><strong id="'+g+'"></strong></td><td></td></tr>':'<div class="alert alert-danger" role="alert" id="'+y+'">Your cart is empty</div>');var C=j.getDiscountPrice(D,e.getTotalPrice(),e.getTotalQuantity());if(D.length&&C!==null){B.append('<tr style="color: red"><td></td><td><strong>Total (including discount)</strong></td><td></td><td></td><td><strong id="'+x+'"></strong></td><td></td></tr>')}t();o()};var m=function(){A();c("#"+u).modal("show")};var z=function(){c.each(c("."+w),function(){var B=c(this).closest("tr").data("id");e.updatePoduct(B,c(this).val())})};var t=function(){c("#"+g).text(j.currencySymbol+e.getTotalPrice())};var o=function(){c("#"+x).text(j.currencySymbol+f.getRoundedNumber(j.getDiscountPrice(e.getAllProducts(),e.getTotalPrice(),e.getTotalQuantity())))};if(j.affixCartIcon){var l=s.offset().top*1+s.css("height").match(/\d+/)*1;var n=s.css("position");c(window).scroll(function(){c(window).scrollTop()>=l?s.addClass(p):s.removeClass(p)})}s.click(function(){j.showCheckoutModal?m():j.clickOnCartIcon(s,e.getAllProducts(),e.getTotalPrice(),e.getTotalQuantity())});c(document).on("input","."+w,function(){var B=c(this).closest("tr").data("price");var D=c(this).closest("tr").data("id");var C=c(this).val();c(this).parent("td").next("."+h).text(j.currencySymbol+f.getRoundedNumber(B*C));e.updatePoduct(D,C);q.text(e.getTotalQuantity());t();o()});c(document).on("keypress","."+w,function(B){if(B.keyCode==38||B.keyCode==40){return}B.preventDefault()});c(document).on("click","."+i,function(){var B=c(this).closest("tr");var C=B.data("id");B.hide(500,function(){e.removeProduct(C);A();q.text(e.getTotalQuantity())})});c("."+r).click(function(){var B=e.getAllProducts();if(!B.length){c("#"+y).fadeTo("fast",0.5).fadeTo("fast",1);return}z();j.checkoutCart(e.getAllProducts(),e.getTotalPrice(),e.getTotalQuantity());e.clearProduct();q.text(e.getTotalQuantity());c("#"+u).modal("hide")})};var d=function(k,l){var g=c(k);var h=b.getOptions(l);var i=c("."+h.classCartIcon);var j=c("."+h.classCartBadge);g.click(function(){h.clickOnAddToCart(g);var r=g.data("id");var n=g.data("name");var m=g.data("summary");var o=g.data("price");var q=g.data("quantity");var p=g.data("image");e.setProduct(r,n,m,o,q,p);j.text(e.getTotalQuantity());h.afterAddOnCart(e.getAllProducts(),e.getTotalPrice(),e.getTotalQuantity())})};c.fn.myCart=function(g){a(g);return c.each(this,function(){new d(this,g)})}})(jQuery);